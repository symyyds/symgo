<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®€å†åˆ¶ä½œå·¥å…·</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/dropdown.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/monokai.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/markdown/markdown.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.1.0/docx.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        .resume-builder-container {
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .resume-panel {
            display: grid;
            grid-template-columns: 300px 1fr 250px;
            gap: 1.5rem;
            margin-top: 1rem;
            height: calc(100vh - 250px);
            min-height: 500px;
        }
        
        .resume-sidebar {
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 1.5rem;
            height: 100%;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }
        
        .resume-content {
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 1.5rem;
            height: 100%;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }
        
        .page-title {
            font-size: 1.8rem;
            color: #333;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
        
        .page-description {
            color: #666;
            margin-bottom: 1.5rem;
            font-size: 0.95rem;
            line-height: 1.5;
        }
        
        .control-panel {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            background: #f7f9fc;
            border-radius: 10px;
            padding: 12px;
            justify-content: flex-start;
            align-items: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            flex-wrap: wrap;
        }
        
        .control-btn {
            padding: 8px 14px;
            background: #1a73e8;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s;
            font-size: 0.85rem;
            font-weight: 500;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .control-btn:hover {
            background: #1557b0;
            transform: translateY(-2px);
            box-shadow: 0 3px 6px rgba(0,0,0,0.12);
        }
        
        .control-btn.secondary {
            background: #5f6368;
        }
        
        .control-btn.secondary:hover {
            background: #3c4043;
        }
        
        .control-group {
            display: flex;
            align-items: center;
            gap: 8px;
            position: relative;
        }
        
        .control-group:not(:last-child)::after {
            content: "";
            position: absolute;
            right: -4px;
            top: 20%;
            height: 60%;
            width: 1px;
            background-color: #e0e0e0;
        }
        
        .templates-section {
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 1.5rem;
            height: 100%;
            overflow-y: auto;
        }
        
        .templates-title {
            font-size: 1rem;
            color: #333;
            margin-bottom: 15px;
            font-weight: 600;
            display: flex;
            align-items: center;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        
        .templates-title i {
            margin-right: 8px;
            color: #1a73e8;
        }
        
        .templates-grid {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 15px;
        }
        
        .template-item {
            height: 140px;
            border: 1px solid #ddd;
            border-radius: 6px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .template-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 12px rgba(0,0,0,0.1);
        }
        
        .template-item.selected {
            border: 2px solid #1a73e8;
            box-shadow: 0 0 0 3px rgba(26, 115, 232, 0.3);
        }
        
        .template-item .template-name {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 4px;
            font-size: 11px;
            text-align: center;
            font-weight: 500;
        }
        
        .resolution-select {
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid #ddd;
            background-color: white;
            font-size: 0.85rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        
        .resume-preview {
            flex: 1;
            padding: 30px;
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 4px;
            position: relative;
            min-height: 800px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
        }
        
        .resume-preview.preview-mode {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 210mm;
            height: 297mm;
            overflow: auto;
            z-index: 2000;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
        }
        
        .close-preview-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.7);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 2001;
            border: none;
            font-size: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            transition: all 0.3s;
        }
        
        .close-preview-btn:hover {
            background: rgba(0,0,0,0.9);
            transform: scale(1.1);
        }
        
        .resume-preview h1 {
            color: #333;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
            margin-top: 25px;
            margin-bottom: 15px;
        }
        
        .resume-preview h2 {
            color: #444;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        
        .resume-preview p {
            margin-bottom: 10px;
        }
        
        .resume-preview ul {
            margin-bottom: 15px;
            padding-left: 20px;
        }
        
        .resume-preview img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 15px 0;
        }
        
        /* ä¸ªäººç…§ç‰‡æ ·å¼æ§åˆ¶ */
        .resume-preview img.personal-photo {
            max-width: 90px !important;
            max-height: 110px !important;
            width: 90px !important;
            height: auto !important;
            object-fit: cover;
            border-radius: 4px;
            margin: 8px 0 !important;
            display: inline-block !important;
        }
        
        .section-item {
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: background-color 0.3s;
            position: relative;
        }
        
        .section-item:hover {
            background-color: #f0f0f0;
        }
        
        .section-item.active {
            background-color: #e8f4fe;
        }
        
        .section-item i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }
        
        .section-item .item-actions {
            position: absolute;
            right: 10px;
            display: flex;
            gap: 5px;
            visibility: hidden;
        }
        
        .section-item:hover .item-actions {
            visibility: visible;
        }
        
        .section-item .action-btn {
            background: none;
            border: none;
            color: #777;
            cursor: pointer;
            padding: 2px;
            border-radius: 3px;
            font-size: 12px;
            transition: all 0.2s;
        }
        
        .section-item .action-btn:hover {
            background: #e0e0e0;
        }
        
        .section-item.hidden {
            opacity: 0.5;
            text-decoration: line-through;
        }
        
        .section-item.hidden .show-hide-btn i {
            color: #f44336;
        }
        
        .add-section-btn {
            padding: 12px;
            margin-top: 20px;
            margin-bottom: 10px;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f5f5f5;
            color: #555;
            border: 1px dashed #ccc;
            transition: all 0.3s;
        }
        
        .add-section-btn:hover {
            background-color: #e0e0e0;
            color: #333;
        }
        
        .add-section-btn i {
            margin-right: 10px;
        }
        
        .section-editor {
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            padding: 20px;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
            width: 600px;
            max-width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            display: none;
        }
        
        .section-editor.active {
            display: block;
            animation: fadeIn 0.3s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .editor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .editor-content textarea {
            width: 100%;
            min-height: 200px;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: monospace;
            resize: vertical;
        }
        
        .editor-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }
        
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            display: none;
        }
        
        .overlay.active {
            display: block;
        }
        
        /* CodeMirrorè‡ªå®šä¹‰æ ·å¼ */
        .CodeMirror {
            height: 300px;
            font-family: monospace;
            font-size: 14px;
            line-height: 1.5;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        /* ç®€å†æ¨¡æ¿æ ·å¼ */
        
        /* ç®€çº¦æ¨¡æ¿ */
        .resume-preview.template-ç®€çº¦ {
            font-family: 'Arial', 'Helvetica', sans-serif;
            color: #333;
            line-height: 1.6;
            background-color: #fff;
            padding: 40px;
        }
        
        .resume-preview.template-ç®€çº¦ h1 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 8px;
            font-size: 22px;
        }
        
        .resume-preview.template-ç®€çº¦ h2 {
            color: #3498db;
            font-size: 18px;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        
        .resume-preview.template-ç®€çº¦ ul {
            list-style-type: square;
        }
        
        .resume-preview.template-ç®€çº¦ img {
            border-radius: 5px;
            border: 1px solid #eee;
        }
        
        /* çš®å¡ä¸˜æ¨¡æ¿ */
        .resume-preview.template-çš®å¡ä¸˜ {
            font-family: 'Comic Sans MS', 'Chalkboard SE', sans-serif;
            color: #333;
            line-height: 1.6;
            background-color: #fff9c4;
            padding: 40px;
            border: 10px solid #ffeb3b;
        }
        
        .resume-preview.template-çš®å¡ä¸˜ h1 {
            color: #e53935;
            border-bottom: 3px dashed #e53935;
            padding-bottom: 8px;
            font-size: 24px;
            text-align: center;
        }
        
        .resume-preview.template-çš®å¡ä¸˜ h2 {
            color: #e53935;
            font-size: 18px;
            margin-top: 20px;
            margin-bottom: 10px;
            text-align: center;
            background-color: #fff;
            border-radius: 20px;
            padding: 5px;
        }
        
        .resume-preview.template-çš®å¡ä¸˜ ul {
            list-style-type: none;
            padding-left: 5px;
        }
        
        .resume-preview.template-çš®å¡ä¸˜ ul li:before {
            content: "âš¡ ";
            color: #e53935;
        }
        
        .resume-preview.template-çš®å¡ä¸˜ img {
            border-radius: 50%;
            border: 5px solid #ffeb3b;
            margin: 0 auto;
            display: block;
        }
        
        /* æ´»åŠ›æ¨¡æ¿ */
        .resume-preview.template-æ´»åŠ› {
            font-family: 'Segoe UI', 'Roboto', sans-serif;
            color: #fff;
            line-height: 1.6;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px;
        }
        
        .resume-preview.template-æ´»åŠ› h1 {
            color: #fff;
            border-bottom: 2px solid rgba(255, 255, 255, 0.5);
            padding-bottom: 8px;
            font-size: 24px;
        }
        
        .resume-preview.template-æ´»åŠ› h2 {
            color: #fff;
            font-size: 18px;
            margin-top: 20px;
            margin-bottom: 10px;
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 10px;
            border-radius: 4px;
        }
        
        .resume-preview.template-æ´»åŠ› ul {
            list-style-type: none;
            padding-left: 10px;
        }
        
        .resume-preview.template-æ´»åŠ› ul li:before {
            content: "â–¶ ";
            color: rgba(255, 255, 255, 0.7);
        }
        
        .resume-preview.template-æ´»åŠ› img {
            border-radius: 8px;
            border: 3px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        /* æ˜ç‘æ¨¡æ¿ */
        .resume-preview.template-æ˜ç‘ {
            font-family: 'Georgia', 'Times New Roman', serif;
            color: #2c3e50;
            line-height: 1.6;
            background-color: #f8f9fa;
            padding: 40px;
            border-left: 15px solid #e74c3c;
        }
        
        .resume-preview.template-æ˜ç‘ h1 {
            color: #e74c3c;
            border-bottom: none;
            padding-bottom: 0;
            font-size: 26px;
            margin-left: -10px;
        }
        
        .resume-preview.template-æ˜ç‘ h2 {
            color: #e74c3c;
            font-size: 20px;
            margin-top: 25px;
            margin-bottom: 15px;
            border-bottom: 1px solid #e74c3c;
            display: inline-block;
        }
        
        .resume-preview.template-æ˜ç‘ ul {
            list-style-type: disc;
        }
        
        .resume-preview.template-æ˜ç‘ p {
            text-align: justify;
        }
        
        .resume-preview.template-æ˜ç‘ img {
            border: none;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }
        
        /* å†°å·æ¨¡æ¿ */
        .resume-preview.template-å†°å· {
            font-family: 'Helvetica Neue', 'Arial', sans-serif;
            color: #2c3e50;
            line-height: 1.6;
            background: linear-gradient(to bottom, #e0f7fa, #ffffff);
            padding: 40px;
            border: 1px solid #b2ebf2;
        }
        
        .resume-preview.template-å†°å· h1 {
            color: #0097a7;
            border-bottom: 2px solid #0097a7;
            padding-bottom: 8px;
            font-size: 24px;
        }
        
        .resume-preview.template-å†°å· h2 {
            color: #00838f;
            font-size: 18px;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        
        .resume-preview.template-å†°å· ul {
            list-style-type: none;
            padding-left: 5px;
        }
        
        .resume-preview.template-å†°å· ul li:before {
            content: "â„ ";
            color: #0097a7;
        }
        
        .resume-preview.template-å†°å· img {
            border-radius: 5px;
            border: 2px solid #b2ebf2;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }
        
        /* æ˜æ˜Ÿæ¨¡æ¿ */
        .resume-preview.template-æ˜æ˜Ÿ {
            font-family: 'Calibri', 'Trebuchet MS', sans-serif;
            color: #333;
            line-height: 1.6;
            background-color: #fff;
            padding: 40px;
            border-top: 10px solid #4caf50;
            border-bottom: 10px solid #4caf50;
        }
        
        .resume-preview.template-æ˜æ˜Ÿ h1 {
            color: #2e7d32;
            text-transform: uppercase;
            letter-spacing: 2px;
            border-bottom: 2px solid #4caf50;
            padding-bottom: 8px;
            font-size: 22px;
            text-align: center;
        }
        
        .resume-preview.template-æ˜æ˜Ÿ h2 {
            color: #388e3c;
            font-size: 18px;
            margin-top: 20px;
            margin-bottom: 10px;
            padding-left: 10px;
            border-left: 4px solid #4caf50;
        }
        
        .resume-preview.template-æ˜æ˜Ÿ ul {
            list-style-type: none;
            padding-left: 5px;
        }
        
        .resume-preview.template-æ˜æ˜Ÿ ul li:before {
            content: "â˜… ";
            color: #4caf50;
        }
        
        .resume-preview.template-æ˜æ˜Ÿ img {
            border-radius: 5px;
            border: 3px solid #4caf50;
        }
        
        .templates-row {
            display: flex;
            overflow-x: auto;
            gap: 15px;
            padding: 15px;
            margin-bottom: 20px;
            background: #f9f9f9;
            border-radius: 8px;
            border: 1px solid #eee;
            scrollbar-width: thin;
            scrollbar-color: #ccc transparent;
        }
        
        .templates-row::-webkit-scrollbar {
            height: 6px;
        }
        
        .templates-row::-webkit-scrollbar-thumb {
            background-color: #ccc;
            border-radius: 6px;
        }
        
        .templates-row::-webkit-scrollbar-track {
            background: transparent;
        }
        
        .template-item {
            flex: 0 0 120px;
            height: 160px;
            border: 1px solid #ddd;
            border-radius: 6px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .template-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .template-item.simple {
            background: white;
        }
        
        .template-item.simple::before {
            content: "";
            position: absolute;
            top: 20px;
            left: 10px;
            right: 10px;
            height: 20px;
            background: #2c3e50;
            border-bottom: 3px solid #3498db;
        }
        
        .template-item.pikachu {
            background: #fff9c4;
            border: 5px solid #ffeb3b;
        }
        
        .template-item.pikachu::before {
            content: "";
            position: absolute;
            top: 20px;
            left: 15px;
            right: 15px;
            height: 20px;
            background: #e53935;
            border-bottom: 3px dashed #e53935;
        }
        
        .template-item.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .template-item.active::before {
            content: "";
            position: absolute;
            top: 20px;
            left: 10px;
            right: 10px;
            height: 20px;
            background: rgba(255, 255, 255, 0.3);
        }
        
        .template-item.mingrui {
            background: #f8f9fa;
            border-left: 10px solid #e74c3c;
        }
        
        .template-item.mingrui::before {
            content: "";
            position: absolute;
            top: 20px;
            left: 10px;
            right: 10px;
            height: 20px;
            background: #e74c3c;
        }
        
        .template-item.glacier {
            background: linear-gradient(to bottom, #e0f7fa, #ffffff);
            border: 1px solid #b2ebf2;
        }
        
        .template-item.glacier::before {
            content: "";
            position: absolute;
            top: 20px;
            left: 10px;
            right: 10px;
            height: 20px;
            background: #0097a7;
        }
        
        .template-item.star {
            background: white;
            border-top: 5px solid #4caf50;
            border-bottom: 5px solid #4caf50;
        }
        
        .template-item.star::before {
            content: "";
            position: absolute;
            top: 20px;
            left: 10px;
            right: 10px;
            height: 20px;
            background: #2e7d32;
        }
        
        .template-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .template-item.selected {
            border: 2px solid #1a73e8;
            box-shadow: 0 0 0 3px rgba(26, 115, 232, 0.3);
            transform: translateY(-3px);
        }
        
        .template-item .template-name {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.6);
            color: white;
            padding: 4px;
            font-size: 12px;
            text-align: center;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="profile">
                <img src="../images/sym_photo.jpg" alt="ä¸ªäººç…§ç‰‡" class="profile-img">
                <div class="profile-info">
                    <h1>å­™è¿œé¸£</h1>
                    <p class="title">ç‹¬å–„å…¶èº«</p>
                    <p class="keywords">CS | SE</p>
                </div>
            </div>
            <nav>
                <ul>
                    <li><a href="../index.html">é¦–é¡µ</a></li>
                    <li><a href="../blog.html">åšå®¢</a></li>
                    <li><a href="../ai.html">AIèŠå¤©</a></li>
                    <li class="dropdown">
                        <a href="#" class="active">å·¥å…·ç®±</a>
                        <div class="dropdown-content">
                            <a href="code_runner.html">ä»£ç é«˜äº®</a>
                            <a href="markdown_to_word.html">Markdownå·¥å…·</a>
                            <a href="python_nav.html">Pythonå­¦ä¹ </a>
                            <a href="deep_learning.html">æ·±åº¦å­¦ä¹ </a>
                            <a href="resume_builder.html" class="active">ç®€å†åˆ¶ä½œ</a>
                        </div>
                    </li>
                    <li><a href="../leave_message.html">ç•™è¨€æ¿</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <div class="resume-builder-container">
        <h1 class="page-title">ç®€å†åˆ¶ä½œå·¥å…·</h1>
        <p class="page-description">åˆ›å»ºä¸€ä»½ä¸“ä¸šçš„ç®€å†ï¼Œæ”¯æŒMarkdownè¯­æ³•ï¼Œå¯ä»¥å¯¼å‡ºä¸ºPDFæˆ–Wordæ ¼å¼ã€‚</p>
        
        <div class="control-panel">
            <div class="control-group">
                <button id="importBtn" class="control-btn">
                    <i class="fas fa-file-import"></i> å¯¼å…¥
                </button>
                <button id="previewBtn" class="control-btn secondary">
                    <i class="fas fa-eye"></i> é¢„è§ˆ
                </button>
            </div>
            
            <div class="control-group">
                <button id="uploadImageBtn" class="control-btn">
                    <i class="fas fa-image"></i> ä¸Šä¼ å›¾ç‰‡
                </button>
            </div>
            
            <div class="control-group">
                <button id="exportPdfBtn" class="control-btn">
                    <i class="fas fa-file-pdf"></i> PDF
                </button>
                <select id="resolutionSelect" class="resolution-select">
                    <option value="1">æ™®é€šæ¸…æ™°åº¦</option>
                    <option value="2" selected>ä¸­ç­‰æ¸…æ™°åº¦</option>
                    <option value="3">é«˜æ¸…æ™°åº¦</option>
                    <option value="4">è¶…é«˜æ¸…</option>
                </select>
                <button id="exportWordBtn" class="control-btn">
                    <i class="fas fa-file-word"></i> Word
                </button>
            </div>
        </div>
        
        <div class="resume-panel">
            <div class="resume-sidebar">
                <!-- èœå•é¡¹éƒ¨åˆ† -->
                <div id="sectionItems">
                    <!-- èœå•é¡¹å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                </div>
                
                <!-- æ·»åŠ æ–°éƒ¨åˆ†æŒ‰é’® -->
                <div class="add-section-btn" id="addSectionBtn">
                    <i class="fas fa-plus"></i> æ·»åŠ æ–°éƒ¨åˆ†
                </div>
            </div>
            
            <div class="resume-content">
                <div class="resume-preview" id="resumePreview">
                    <!-- ç®€å†å†…å®¹å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
            
            <!-- æ¨¡æ¿é€‰æ‹©ç§»åˆ°å³ä¾§ -->
            <div class="templates-section">
                <div class="templates-title">
                    <i class="fas fa-palette"></i> é€‰æ‹©æ¨¡æ¿æ ·å¼
                </div>
                <div class="templates-grid">
                    <div class="template-item simple selected" data-template="ç®€çº¦">
                        <div class="template-name">ç®€çº¦</div>
                    </div>
                    <div class="template-item pikachu" data-template="çš®å¡ä¸˜">
                        <div class="template-name">çš®å¡ä¸˜</div>
                    </div>
                    <div class="template-item active" data-template="æ´»åŠ›">
                        <div class="template-name">æ´»åŠ›</div>
                    </div>
                    <div class="template-item mingrui" data-template="æ˜ç‘">
                        <div class="template-name">æ˜ç‘</div>
                    </div>
                    <div class="template-item glacier" data-template="å†°å·">
                        <div class="template-name">å†°å·</div>
                    </div>
                    <div class="template-item star" data-template="æ˜æ˜Ÿ">
                        <div class="template-name">æ˜æ˜Ÿ</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ç¼–è¾‘å¼¹çª— -->
    <div class="overlay" id="overlay"></div>
    <div class="section-editor" id="sectionEditor">
        <div class="editor-header">
            <h3 id="editorTitle">ç¼–è¾‘éƒ¨åˆ†</h3>
            <button id="closeEditor" class="control-btn secondary">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="editor-content">
            <p>æ”¯æŒMarkdownè¯­æ³•</p>
            <div id="markdownEditor"></div>
        </div>
        <div class="editor-actions">
            <button id="cancelEdit" class="control-btn secondary">
                <i class="fas fa-times"></i> å–æ¶ˆ
            </button>
            <button id="saveEdit" class="control-btn">
                <i class="fas fa-save"></i> ä¿å­˜
            </button>
        </div>
    </div>
    
    <!-- å›¾ç‰‡ä¸Šä¼ å¼¹çª— -->
    <div class="section-editor" id="imageUploader">
        <div class="editor-header">
            <h3>ä¸Šä¼ å›¾ç‰‡</h3>
            <button id="closeUploader" class="control-btn secondary">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="editor-content">
            <p>é€‰æ‹©è¦ä¸Šä¼ çš„å›¾ç‰‡ï¼š</p>
            <input type="file" id="imageFile" accept="image/*">
            <p style="color: #666; font-size: 12px; margin-top: 5px;">
                æ”¯æŒJPGã€PNGã€GIFæ ¼å¼ï¼Œå›¾ç‰‡å¤§å°ä¸è¶…è¿‡5MB
            </p>
            <div id="imagePreview" style="margin-top: 15px; max-width: 100%; min-height: 100px;"></div>
        </div>
        <div class="editor-actions">
            <button id="cancelUpload" class="control-btn secondary">
                <i class="fas fa-times"></i> å–æ¶ˆ
            </button>
            <button id="insertImage" class="control-btn">
                <i class="fas fa-plus"></i> æ’å…¥å›¾ç‰‡
            </button>
        </div>
    </div>

    <!-- æ·»åŠ æ–°éƒ¨åˆ†å¼¹çª— -->
    <div class="section-editor" id="addSectionDialog">
        <div class="editor-header">
            <h3>æ·»åŠ æ–°éƒ¨åˆ†</h3>
            <button id="closeAddDialog" class="control-btn secondary">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="editor-content">
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px;">éƒ¨åˆ†åç§°:</label>
                <input type="text" id="newSectionName" style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ddd;">
            </div>
            <div>
                <label style="display: block; margin-bottom: 5px;">å›¾æ ‡:</label>
                <select id="newSectionIcon" style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ddd;">
                    <option value="fa-briefcase">ğŸ’¼ å·¥ä½œ/èŒä¸š</option>
                    <option value="fa-graduation-cap">ğŸ“ æ•™è‚²/å­¦æœ¯</option>
                    <option value="fa-code">ğŸ’» ç¼–ç¨‹/æŠ€æœ¯</option>
                    <option value="fa-trophy">ğŸ† æˆå°±/å¥–é¡¹</option>
                    <option value="fa-tools">ğŸ”§ æŠ€èƒ½/å·¥å…·</option>
                    <option value="fa-project-diagram">ğŸ“Š é¡¹ç›®/ç ”ç©¶</option>
                    <option value="fa-user-friends">ğŸ‘¥ ç¤¾äº¤/å¿—æ„¿è€…</option>
                    <option value="fa-certificate">ğŸ“œ è¯ä¹¦/èµ„æ ¼</option>
                    <option value="fa-book">ğŸ“š å‡ºç‰ˆç‰©/æ–‡ç« </option>
                    <option value="fa-globe">ğŸŒ è¯­è¨€/å›½é™…</option>
                    <option value="fa-palette">ğŸ¨ åˆ›æ„/è‰ºæœ¯</option>
                    <option value="fa-heart">â¤ï¸ å…´è¶£/çˆ±å¥½</option>
                    <option value="fa-trophy">ğŸ… æŠ€èƒ½è¯„ä¼°</option>
                    <option value="fa-clipboard-list">ğŸ“‹ å·¥ä½œæ¸…å•</option>
                </select>
            </div>
        </div>
        <div class="editor-actions">
            <button id="cancelAddSection" class="control-btn secondary">
                <i class="fas fa-times"></i> å–æ¶ˆ
            </button>
            <button id="saveNewSection" class="control-btn">
                <i class="fas fa-plus"></i> æ·»åŠ 
            </button>
        </div>
    </div>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <h3>WEB</h3>
                </div>
                <div class="footer-links">
                    <h4>å¿«é€Ÿé“¾æ¥</h4>
                    <ul>
                        <li><a href="../index.html">é¦–é¡µ</a></li>
                    </ul>
                </div>
                <div class="footer-contact">
                    <h4>è”ç³»æ–¹å¼</h4>
                    <p><i class="fas fa-envelope"></i> 19861208800@163.com</p>
                    <p><i class="fas fa-phone"></i> +86-19861208800</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 sym. ä¿ç•™æ‰€æœ‰æƒåˆ©.</p>
            </div>
        </div>
    </footer>

    <!-- JavaScriptéƒ¨åˆ†å¾…å®ç° -->
    <script>
        // åˆå§‹åŒ–å˜é‡
        let currentSection = 'personal-info';
        let currentTemplate = 'ç®€çº¦';
        let editor;
        
        // é»˜è®¤éƒ¨åˆ†é…ç½®
        const defaultSections = [
            { id: 'personal-info', name: 'ä¸ªäººä¿¡æ¯', icon: 'fa-user', hidden: false },
            { id: 'self-evaluation', name: 'è‡ªæˆ‘è¯„ä»·', icon: 'fa-comment', hidden: false },
            { id: 'work-history', name: 'å·¥ä½œç»å†', icon: 'fa-briefcase', hidden: false },
            { id: 'education', name: 'æ•™è‚²ç»å†', icon: 'fa-graduation-cap', hidden: false },
            { id: 'honors', name: 'è£èª‰å¥–ç« ', icon: 'fa-award', hidden: false },
            { id: 'skills', name: 'ä¸“ä¸šæŠ€èƒ½', icon: 'fa-tools', hidden: false },
            { id: 'interests', name: 'å…´è¶£çˆ±å¥½', icon: 'fa-heart', hidden: false },
            { id: 'languages', name: 'è¯­è¨€èƒ½åŠ›', icon: 'fa-language', hidden: false },
            { id: 'projects', name: 'é¡¹ç›®ç»éªŒ', icon: 'fa-project-diagram', hidden: false },
            { id: 'others', name: 'å…¶ä»–ä¿¡æ¯', icon: 'fa-ellipsis-h', hidden: false }
        ];
        
        // ä»æœ¬åœ°å­˜å‚¨åŠ è½½éƒ¨åˆ†é…ç½®ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä½¿ç”¨é»˜è®¤é…ç½®
        let sectionConfig = JSON.parse(localStorage.getItem('resumeSectionConfig')) || defaultSections;
        
        // ä»æœ¬åœ°å­˜å‚¨ä¸­åŠ è½½æ•°æ®æˆ–ä½¿ç”¨é»˜è®¤æ•°æ®
        let resumeData = JSON.parse(localStorage.getItem('resumeData')) || {
            'personal-info': `# ä¸ªäººä¿¡æ¯\n\nå§“åï¼šå¼ ä¸‰\nç”µè¯ï¼š13800138000\né‚®ç®±ï¼šzhangsan@example.com\nåœ°å€ï¼šåŒ—äº¬å¸‚æµ·æ·€åŒºXXè¡—é“\n\n![ä¸ªäººç…§ç‰‡](https://via.placeholder.com/150)`,
            'self-evaluation': `# è‡ªæˆ‘è¯„ä»·\n\næˆ‘æ˜¯ä¸€åå……æ»¡æ¿€æƒ…çš„è½¯ä»¶å¼€å‘è€…ï¼Œæ‹¥æœ‰5å¹´çš„å¼€å‘ç»éªŒã€‚æˆ‘çƒ­çˆ±å­¦ä¹ æ–°æŠ€æœ¯ï¼Œå–„äºè§£å†³å¤æ‚é—®é¢˜ï¼Œèƒ½å¤Ÿå¿«é€Ÿé€‚åº”æ–°ç¯å¢ƒã€‚`,
            'work-history': `# å·¥ä½œç»å†\n\n## ABCç§‘æŠ€æœ‰é™å…¬å¸ | é«˜çº§å¼€å‘å·¥ç¨‹å¸ˆ\n**2020å¹´6æœˆ - è‡³ä»Š**\n\n- è´Ÿè´£å…¬å¸æ ¸å¿ƒäº§å“çš„åç«¯å¼€å‘å’Œç»´æŠ¤\n- ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢ï¼Œæå‡ç³»ç»Ÿæ€§èƒ½30%\n- å¸¦é¢†5äººå°ç»„å®Œæˆæ–°åŠŸèƒ½çš„å¼€å‘å’Œéƒ¨ç½²\n\n## XYZä¿¡æ¯æŠ€æœ¯æœ‰é™å…¬å¸ | å¼€å‘å·¥ç¨‹å¸ˆ\n**2018å¹´7æœˆ - 2020å¹´5æœˆ**\n\n- å‚ä¸ç”µå•†å¹³å°çš„å¼€å‘å’Œç»´æŠ¤\n- å®ç°RESTful APIæ¥å£ï¼Œå¯¹æ¥ç§»åŠ¨ç«¯åº”ç”¨\n- è§£å†³ç”Ÿäº§ç¯å¢ƒä¸­çš„æŠ€æœ¯é—®é¢˜å’Œæ€§èƒ½ç“¶é¢ˆ`,
            'education': `# æ•™è‚²ç»å†\n\n## åŒ—äº¬å¤§å­¦ | è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯ | ç¡•å£«\n**2015å¹´9æœˆ - 2018å¹´6æœˆ**\n\n- GPA: 3.8/4.0\n- ç ”ç©¶æ–¹å‘ï¼šæœºå™¨å­¦ä¹ ä¸æ•°æ®æŒ–æ˜\n- è·å¾—ä¼˜ç§€æ¯•ä¸šç”Ÿç§°å·\n\n## åä¸­ç§‘æŠ€å¤§å­¦ | è½¯ä»¶å·¥ç¨‹ | å­¦å£«\n**2011å¹´9æœˆ - 2015å¹´6æœˆ**\n\n- GPA: 3.7/4.0\n- è·å¾—æ ¡çº§å¥–å­¦é‡‘3æ¬¡`,
            'honors': `# è£èª‰å¥–ç« \n\n- 2022å¹´åº¦å…¬å¸æŠ€æœ¯ä¹‹æ˜Ÿ\n- 2020å¹´åº¦æœ€ä½³å›¢é˜Ÿæˆå‘˜\n- 2019å¹´åº¦æŠ€æœ¯åˆ›æ–°å¥–`,
            'skills': `# ä¸“ä¸šæŠ€èƒ½\n\n- **ç¼–ç¨‹è¯­è¨€**ï¼šJava, Python, JavaScript, C++\n- **å‰ç«¯æŠ€æœ¯**ï¼šReact, Vue.js, HTML5, CSS3\n- **åç«¯æŠ€æœ¯**ï¼šSpring Boot, Django, Node.js\n- **æ•°æ®åº“**ï¼šMySQL, MongoDB, Redis\n- **å·¥å…·**ï¼šGit, Docker, Jenkins, JIRA`,
            'interests': `# å…´è¶£çˆ±å¥½\n\n- ç¼–ç¨‹ç«èµ›\n- æŠ€æœ¯åšå®¢å†™ä½œ\n- æˆ·å¤–å¾’æ­¥\n- æ‘„å½±`,
            'languages': `# è¯­è¨€èƒ½åŠ›\n\n- ä¸­æ–‡ï¼ˆæ¯è¯­ï¼‰\n- è‹±è¯­ï¼ˆæµåˆ©ï¼Œæ‰˜ç¦100åˆ†ï¼‰\n- æ—¥è¯­ï¼ˆåŸºç¡€ï¼‰`,
            'projects': `# é¡¹ç›®ç»éªŒ\n\n## æ™ºèƒ½å®¢æœç³»ç»Ÿ\n**2021å¹´3æœˆ - 2021å¹´12æœˆ**\n\nä½¿ç”¨NLPæŠ€æœ¯æ‰“é€ çš„æ™ºèƒ½å®¢æœç³»ç»Ÿï¼Œèƒ½è‡ªåŠ¨å›ç­”ç”¨æˆ·é—®é¢˜ï¼Œæé«˜å®¢æœæ•ˆç‡80%ã€‚\n\n- æŠ€æœ¯æ ˆï¼šPython, TensorFlow, Flask, Vue.js\n- è´Ÿè´£ç®—æ³•è®¾è®¡å’Œåç«¯å¼€å‘\n- å®ç°äº†æ„å›¾è¯†åˆ«å’Œå®ä½“æŠ½å–åŠŸèƒ½\n\n## ç”µå•†æ•°æ®åˆ†æå¹³å°\n**2019å¹´5æœˆ - 2020å¹´2æœˆ**\n\nä¸ºç”µå•†å¹³å°æ„å»ºçš„æ•°æ®åˆ†æç³»ç»Ÿï¼Œæä¾›é”€å”®é¢„æµ‹ã€ç”¨æˆ·è¡Œä¸ºåˆ†æç­‰åŠŸèƒ½ã€‚\n\n- æŠ€æœ¯æ ˆï¼šJava, Spring Boot, MySQL, ELK, React\n- è´Ÿè´£æ•°æ®å¤„ç†å’Œåˆ†ææ¨¡å—\n- è®¾è®¡å¹¶å®ç°äº†å®æ—¶æ•°æ®å¤„ç†ç®¡é“`,
            'others': `# å…¶ä»–ä¿¡æ¯\n\n## è¯ä¹¦\n- AWSè®¤è¯è§£å†³æ–¹æ¡ˆæ¶æ„å¸ˆ\n- Oracleè®¤è¯Javaå·¥ç¨‹å¸ˆ\n\n## ç¤¾åŒºè´¡çŒ®\n- GitHubå¼€æºé¡¹ç›®ç»´æŠ¤è€…\n- æŠ€æœ¯ç¤¾åŒºæ´»è·ƒè´¡çŒ®è€…`
        };

        // åŠ è½½å½“å‰é€‰ä¸­çš„æ¨¡æ¿ï¼ˆå¦‚æœæœ‰æœ¬åœ°å­˜å‚¨ï¼‰
        currentTemplate = localStorage.getItem('currentTemplate') || 'ç®€çº¦';
        
        // æ¸…æ™°åº¦è®¾ç½®
        let exportResolution = localStorage.getItem('resumeExportResolution') || '2';

        // DOMå…ƒç´ åŠ è½½å®Œæˆåæ‰§è¡Œ
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–ç¼–è¾‘å™¨
            editor = CodeMirror(document.getElementById('markdownEditor'), {
                mode: 'markdown',
                theme: 'monokai',
                lineNumbers: true,
                lineWrapping: true,
                extraKeys: {"Enter": "newlineAndIndentContinueMarkdownList"}
            });
            
            // æ¸²æŸ“èœå•é¡¹
            renderSectionItems();
            
            // æ¸²æŸ“åˆå§‹ç®€å†
            renderResume();
            
            // æ¸…æ™°åº¦é€‰æ‹©
            document.getElementById('resolutionSelect').value = exportResolution;
            document.getElementById('resolutionSelect').addEventListener('change', function() {
                exportResolution = this.value;
                localStorage.setItem('resumeExportResolution', exportResolution);
            });
            
            // ç»‘å®šæ¨¡æ¿é€‰æ‹©äº‹ä»¶
            document.querySelectorAll('.template-item').forEach(item => {
                item.addEventListener('click', function() {
                    // ç§»é™¤ä¹‹å‰çš„selectedç±»
                    document.querySelector('.template-item.selected').classList.remove('selected');
                    // æ·»åŠ æ–°çš„selectedç±»
                    this.classList.add('selected');
                    // æ›´æ–°å½“å‰æ¨¡æ¿
                    currentTemplate = this.getAttribute('data-template');
                    // ä¿å­˜å½“å‰æ¨¡æ¿åˆ°æœ¬åœ°å­˜å‚¨
                    localStorage.setItem('currentTemplate', currentTemplate);
                    // é‡æ–°æ¸²æŸ“ç®€å†
                    renderResume();
                });
            });
            
            // ç¼–è¾‘å™¨ç›¸å…³äº‹ä»¶
            document.getElementById('closeEditor').addEventListener('click', closeEditor);
            document.getElementById('cancelEdit').addEventListener('click', closeEditor);
            document.getElementById('saveEdit').addEventListener('click', saveEdit);
            document.getElementById('overlay').addEventListener('click', closeEditor);
            
            // å›¾ç‰‡ä¸Šä¼ ç›¸å…³äº‹ä»¶
            document.getElementById('uploadImageBtn').addEventListener('click', openImageUploader);
            document.getElementById('closeUploader').addEventListener('click', closeImageUploader);
            document.getElementById('cancelUpload').addEventListener('click', closeImageUploader);
            document.getElementById('insertImage').addEventListener('click', insertImage);
            document.getElementById('imageFile').addEventListener('change', previewImage);
            
            // å¯¼å‡ºç›¸å…³äº‹ä»¶
            document.getElementById('exportPdfBtn').addEventListener('click', exportToPdf);
            document.getElementById('exportWordBtn').addEventListener('click', exportToWord);
            document.getElementById('importBtn').addEventListener('click', importResume);
            document.getElementById('previewBtn').addEventListener('click', togglePreview);
            
            // æ·»åŠ æ–°éƒ¨åˆ†ç›¸å…³äº‹ä»¶
            document.getElementById('addSectionBtn').addEventListener('click', openAddSectionDialog);
            document.getElementById('closeAddDialog').addEventListener('click', closeAddSectionDialog);
            document.getElementById('cancelAddSection').addEventListener('click', closeAddSectionDialog);
            document.getElementById('saveNewSection').addEventListener('click', addNewSection);
        });
        
        // æ¸²æŸ“èœå•é¡¹
        function renderSectionItems() {
            const container = document.getElementById('sectionItems');
            container.innerHTML = '';
            
            // ä¸ºæ¯ä¸ªéƒ¨åˆ†åˆ›å»ºèœå•é¡¹
            sectionConfig.forEach((section, index) => {
                const sectionItem = document.createElement('div');
                sectionItem.className = `section-item${section.id === currentSection ? ' active' : ''}${section.hidden ? ' hidden' : ''}`;
                sectionItem.setAttribute('data-section', section.id);
                sectionItem.innerHTML = `
                    <i class="fas ${section.icon}"></i>
                    <span>${section.name}</span>
                    <div class="item-actions">
                        ${index > 0 ? `<button class="action-btn move-up-btn" title="ä¸Šç§»"><i class="fas fa-arrow-up"></i></button>` : ''}
                        ${index < sectionConfig.length - 1 ? `<button class="action-btn move-down-btn" title="ä¸‹ç§»"><i class="fas fa-arrow-down"></i></button>` : ''}
                        <button class="action-btn show-hide-btn" title="${section.hidden ? 'æ˜¾ç¤º' : 'éšè—'}"><i class="fas ${section.hidden ? 'fa-eye' : 'fa-eye-slash'}"></i></button>
                    </div>
                `;
                
                // ç‚¹å‡»éƒ¨åˆ†åˆ‡æ¢ç¼–è¾‘
                sectionItem.addEventListener('click', function(e) {
                    // åªæœ‰ç‚¹å‡»æ•´ä¸ªåŒºåŸŸè€Œä¸æ˜¯æŒ‰é’®æ—¶æ‰åˆ‡æ¢éƒ¨åˆ†
                    if (!e.target.closest('.action-btn')) {
                        document.querySelector('.section-item.active')?.classList.remove('active');
                        this.classList.add('active');
                        currentSection = this.getAttribute('data-section');
                        openEditor();
                    }
                });
                
                container.appendChild(sectionItem);
                
                // ä¸Šç§»æŒ‰é’®
                const moveUpBtn = sectionItem.querySelector('.move-up-btn');
                if (moveUpBtn) {
                    moveUpBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        moveSection(index, 'up');
                    });
                }
                
                // ä¸‹ç§»æŒ‰é’®
                const moveDownBtn = sectionItem.querySelector('.move-down-btn');
                if (moveDownBtn) {
                    moveDownBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        moveSection(index, 'down');
                    });
                }
                
                // æ˜¾ç¤º/éšè—æŒ‰é’®
                const showHideBtn = sectionItem.querySelector('.show-hide-btn');
                if (showHideBtn) {
                    showHideBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        toggleSectionVisibility(index);
                    });
                }
            });
        }
        
        // ä¸Šä¸‹ç§»åŠ¨éƒ¨åˆ†
        function moveSection(index, direction) {
            if (direction === 'up' && index > 0) {
                const temp = sectionConfig[index];
                sectionConfig[index] = sectionConfig[index - 1];
                sectionConfig[index - 1] = temp;
            } else if (direction === 'down' && index < sectionConfig.length - 1) {
                const temp = sectionConfig[index];
                sectionConfig[index] = sectionConfig[index + 1];
                sectionConfig[index + 1] = temp;
            }
            
            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
            localStorage.setItem('resumeSectionConfig', JSON.stringify(sectionConfig));
            
            // é‡æ–°æ¸²æŸ“èœå•å’Œç®€å†
            renderSectionItems();
            renderResume();
        }
        
        // åˆ‡æ¢éƒ¨åˆ†å¯è§æ€§
        function toggleSectionVisibility(index) {
            sectionConfig[index].hidden = !sectionConfig[index].hidden;
            
            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
            localStorage.setItem('resumeSectionConfig', JSON.stringify(sectionConfig));
            
            // é‡æ–°æ¸²æŸ“èœå•å’Œç®€å†
            renderSectionItems();
            renderResume();
        }
        
        // æ‰“å¼€æ·»åŠ æ–°éƒ¨åˆ†å¯¹è¯æ¡†
        function openAddSectionDialog() {
            document.getElementById('overlay').classList.add('active');
            document.getElementById('addSectionDialog').classList.add('active');
            document.getElementById('newSectionName').value = '';
            document.getElementById('newSectionIcon').value = 'fa-briefcase';
        }
        
        // å…³é—­æ·»åŠ æ–°éƒ¨åˆ†å¯¹è¯æ¡†
        function closeAddSectionDialog() {
            document.getElementById('overlay').classList.remove('active');
            document.getElementById('addSectionDialog').classList.remove('active');
        }
        
        // æ·»åŠ æ–°éƒ¨åˆ†
        function addNewSection() {
            const name = document.getElementById('newSectionName').value.trim();
            const icon = document.getElementById('newSectionIcon').value;
            
            if (name) {
                // ç”Ÿæˆå”¯ä¸€ID
                const id = 'custom-' + Date.now();
                
                // æ·»åŠ åˆ°éƒ¨åˆ†é…ç½®
                sectionConfig.push({
                    id: id,
                    name: name,
                    icon: icon,
                    hidden: false
                });
                
                // åˆå§‹åŒ–æ–°éƒ¨åˆ†çš„å†…å®¹
                resumeData[id] = `# ${name}\n\nåœ¨è¿™é‡Œæ·»åŠ å†…å®¹...`;
                
                // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                localStorage.setItem('resumeSectionConfig', JSON.stringify(sectionConfig));
                localStorage.setItem('resumeData', JSON.stringify(resumeData));
                
                // é‡æ–°æ¸²æŸ“èœå•å’Œç®€å†
                renderSectionItems();
                renderResume();
                
                // å…³é—­å¯¹è¯æ¡†
                closeAddSectionDialog();
                
                // åˆ‡æ¢åˆ°æ–°éƒ¨åˆ†è¿›è¡Œç¼–è¾‘
                currentSection = id;
                openEditor();
            } else {
                alert('è¯·è¾“å…¥éƒ¨åˆ†åç§°');
            }
        }
        
        // æ¸²æŸ“ç®€å†
        function renderResume() {
            const preview = document.getElementById('resumePreview');
            let resumeHTML = '';
            
            // æ ¹æ®ä¸åŒæ¨¡æ¿åº”ç”¨ä¸åŒæ ·å¼
            preview.className = 'resume-preview template-' + currentTemplate;
            
            // æŒ‰ç…§é…ç½®é¡ºåºæ¸²æŸ“éƒ¨åˆ†å†…å®¹
            sectionConfig.forEach(section => {
                // åªæ¸²æŸ“æœªéšè—çš„éƒ¨åˆ†
                if (!section.hidden && resumeData[section.id]) {
                    resumeHTML += marked.parse(resumeData[section.id]);
                }
            });
            
            preview.innerHTML = resumeHTML;
            
            // å¤„ç†æ‰€æœ‰å›¾ç‰‡ï¼Œåº”ç”¨è‡ªå®šä¹‰æ ·å¼ç±»
            preview.querySelectorAll('img').forEach(img => {
                // è·å–å›¾ç‰‡å…ƒç´ åçš„æ–‡æœ¬èŠ‚ç‚¹ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰ç±»åå®šä¹‰
                const nextSibling = img.nextSibling;
                if (nextSibling && nextSibling.nodeType === Node.TEXT_NODE) {
                    const text = nextSibling.nodeValue;
                    const classMatch = text.match(/\{\.([a-zA-Z0-9-]+)\}/);
                    if (classMatch) {
                        // æ·»åŠ ç±»åå¹¶ç§»é™¤æ–‡æœ¬èŠ‚ç‚¹ä¸­çš„ç±»åæ ‡è®°
                        img.classList.add(classMatch[1]);
                        nextSibling.nodeValue = text.replace(/\{\.([a-zA-Z0-9-]+)\}/, '');
                    }
                }
                
                // å¦‚æœåœ¨ä¸ªäººä¿¡æ¯éƒ¨åˆ†ä¸”æ²¡æœ‰ç±»åï¼Œè‡ªåŠ¨æ·»åŠ ä¸ªäººç…§ç‰‡ç±»
                const isInPersonalInfo = img.closest('h1')?.textContent.includes('ä¸ªäººä¿¡æ¯') || 
                                        img.closest('p')?.previousElementSibling?.textContent.includes('ä¸ªäººä¿¡æ¯');
                if (isInPersonalInfo && !img.className) {
                    img.classList.add('personal-photo');
                }
            });
        }
        
        // æ‰“å¼€ç¼–è¾‘å™¨
        function openEditor() {
            document.getElementById('editorTitle').textContent = `ç¼–è¾‘ ${getDisplayName(currentSection)}`;
            editor.setValue(resumeData[currentSection] || '');
            document.getElementById('overlay').classList.add('active');
            document.getElementById('sectionEditor').classList.add('active');
            editor.refresh(); // åˆ·æ–°ç¼–è¾‘å™¨ä»¥é¿å…æ˜¾ç¤ºé—®é¢˜
            setTimeout(() => editor.focus(), 100);
        }
        
        // å…³é—­ç¼–è¾‘å™¨
        function closeEditor() {
            document.getElementById('overlay').classList.remove('active');
            document.getElementById('sectionEditor').classList.remove('active');
        }
        
        // ä¿å­˜ç¼–è¾‘å†…å®¹
        function saveEdit() {
            resumeData[currentSection] = editor.getValue();
            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
            localStorage.setItem('resumeData', JSON.stringify(resumeData));
            renderResume();
            closeEditor();
        }
        
        // æ‰“å¼€å›¾ç‰‡ä¸Šä¼ å™¨
        function openImageUploader() {
            document.getElementById('overlay').classList.add('active');
            document.getElementById('imageUploader').classList.add('active');
            document.getElementById('imagePreview').innerHTML = '';
            document.getElementById('imageFile').value = '';
        }
        
        // å…³é—­å›¾ç‰‡ä¸Šä¼ å™¨
        function closeImageUploader() {
            document.getElementById('overlay').classList.remove('active');
            document.getElementById('imageUploader').classList.remove('active');
        }
        
        // é¢„è§ˆä¸Šä¼ çš„å›¾ç‰‡
        function previewImage() {
            const file = document.getElementById('imageFile').files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    // åˆ›å»ºä¸€ä¸ªä¸´æ—¶å›¾ç‰‡å…ƒç´ æ¥è·å–åŸå§‹å°ºå¯¸
                    const tempImg = new Image();
                    tempImg.onload = function() {
                        // æ˜¾ç¤ºåŸå§‹å°ºå¯¸
                        const originalWidth = tempImg.width;
                        const originalHeight = tempImg.height;
                        
                        // åˆ›å»ºé¢„è§ˆå›¾ç‰‡
                        const img = document.createElement('img');
                        img.src = e.target.result;
                        img.style.maxWidth = '100%';
                        img.style.maxHeight = '200px';
                        
                        // æ¸…ç©ºå¹¶æ·»åŠ é¢„è§ˆ
                        const previewEl = document.getElementById('imagePreview');
                        previewEl.innerHTML = '';
                        previewEl.appendChild(img);
                        
                        // æ·»åŠ å°ºå¯¸ä¿¡æ¯
                        const sizeInfo = document.createElement('p');
                        sizeInfo.style.fontSize = '12px';
                        sizeInfo.style.color = '#666';
                        sizeInfo.textContent = `åŸå§‹å°ºå¯¸: ${originalWidth}Ã—${originalHeight}px`;
                        previewEl.appendChild(sizeInfo);
                    };
                    tempImg.src = e.target.result;
                }
                reader.onerror = function() {
                    console.error('è¯»å–æ–‡ä»¶å¤±è´¥');
                    alert('æ— æ³•è¯»å–å›¾ç‰‡æ–‡ä»¶ï¼Œè¯·é‡è¯•');
                }
                try {
                    reader.readAsDataURL(file);
                } catch (error) {
                    console.error('è¯»å–æ–‡ä»¶æ—¶å‡ºé”™:', error);
                    alert('è¯»å–æ–‡ä»¶æ—¶å‡ºé”™ï¼Œè¯·é€‰æ‹©æœ‰æ•ˆçš„å›¾ç‰‡æ–‡ä»¶');
                }
            }
        }
        
        // å¤„ç†å›¾ç‰‡å¤§å°ï¼Œè¿”å›è°ƒæ•´åçš„æ•°æ®URL
        function resizeImage(dataUrl, maxWidth, maxHeight, quality = 0.8) {
            return new Promise((resolve, reject) => {
                const img = new Image();
                img.onload = function() {
                    let width = img.width;
                    let height = img.height;
                    
                    // è®¡ç®—ç¼©æ”¾æ¯”ä¾‹
                    if (width > maxWidth || height > maxHeight) {
                        const ratioWidth = maxWidth / width;
                        const ratioHeight = maxHeight / height;
                        const ratio = Math.min(ratioWidth, ratioHeight);
                        
                        width = width * ratio;
                        height = height * ratio;
                    }
                    
                    // å¯¹äºä¸ªäººç…§ç‰‡ï¼Œä½¿ç”¨å›ºå®šå°ºå¯¸
                    if (maxWidth === 300 && maxHeight === 400) {
                        width = 90;  // å›ºå®šæ›´å°çš„å®½åº¦
                        const newHeight = Math.round((height / width) * 90);
                        height = Math.min(newHeight, 110);  // ç¡®ä¿é«˜åº¦ä¸è¶…è¿‡110px
                    } else {
                        // è¿›ä¸€æ­¥ç¼©å°éä¸ªäººç…§ç‰‡
                        width = Math.min(width, 300);
                        // ä¿æŒåŸæ¯”ä¾‹è°ƒæ•´é«˜åº¦
                        height = Math.round(height * (width / img.width));
                    }
                    
                    // åˆ›å»ºcanvaså¹¶ç»˜åˆ¶è°ƒæ•´åçš„å›¾ç‰‡
                    const canvas = document.createElement('canvas');
                    canvas.width = width;
                    canvas.height = height;
                    
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0, width, height);
                    
                    // å°†canvasè½¬æ¢ä¸ºæ•°æ®URLï¼Œå¢åŠ å‹ç¼©ç‡
                    const resizedDataUrl = canvas.toDataURL('image/jpeg', quality);
                    resolve(resizedDataUrl);
                };
                
                img.onerror = function() {
                    reject(new Error('å›¾ç‰‡å¤„ç†å¤±è´¥'));
                };
                
                img.src = dataUrl;
            });
        }
        
        // æ’å…¥å›¾ç‰‡åˆ°å½“å‰ç¼–è¾‘çš„éƒ¨åˆ†
        function insertImage() {
            const file = document.getElementById('imageFile').files[0];
            if (file) {
                // æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶
                if (!file.type.startsWith('image/')) {
                    alert('è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶');
                    return;
                }
                
                // æ˜¯å¦å°†å›¾ç‰‡ä½œä¸ºä¸ªäººç…§ç‰‡å¤„ç†ï¼ˆæ ¹æ®å½“å‰ç¼–è¾‘çš„éƒ¨åˆ†åˆ¤æ–­ï¼‰
                const isPersonalPhoto = currentSection === 'personal-info';
                
                // è®¾ç½®æœ€å¤§å°ºå¯¸ - æ›´å°çš„å°ºå¯¸
                const maxWidth = isPersonalPhoto ? 300 : 400;
                const maxHeight = isPersonalPhoto ? 400 : 250;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    const originalDataUrl = e.target.result;
                    
                    // è°ƒæ•´å›¾ç‰‡å¤§å°ï¼Œå¢åŠ å‹ç¼©ç‡
                    resizeImage(originalDataUrl, maxWidth, maxHeight, 0.7)
                        .then(resizedDataUrl => {
                            // æ„å»ºMarkdownå›¾ç‰‡æ ‡è®°ï¼Œä¸ºä¸ªäººç…§ç‰‡æ·»åŠ ç±»å
                            const className = isPersonalPhoto ? ' {.personal-photo}' : '';
                            const imageMd = `\n\n![å›¾ç‰‡](${resizedDataUrl})${className}\n\n`;
                            
                            // å°†å›¾ç‰‡æ’å…¥åˆ°å…‰æ ‡ä½ç½®
                            const cursor = editor.getCursor();
                            editor.replaceRange(imageMd, cursor);
                            
                            closeImageUploader();
                            // ç¡®ä¿ç¼–è¾‘å™¨æ˜¯æ‰“å¼€çš„
                            if (!document.getElementById('sectionEditor').classList.contains('active')) {
                                openEditor();
                            }
                            
                            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                            resumeData[currentSection] = editor.getValue();
                            localStorage.setItem('resumeData', JSON.stringify(resumeData));
                            renderResume();
                        })
                        .catch(error => {
                            console.error('è°ƒæ•´å›¾ç‰‡å¤§å°å¤±è´¥:', error);
                            alert('å›¾ç‰‡å¤„ç†å¤±è´¥ï¼Œè¯·é‡è¯•');
                        });
                }
                reader.onerror = function() {
                    console.error('è¯»å–æ–‡ä»¶å¤±è´¥');
                    alert('æ— æ³•è¯»å–å›¾ç‰‡æ–‡ä»¶ï¼Œè¯·é‡è¯•');
                }
                try {
                    reader.readAsDataURL(file);
                } catch (error) {
                    console.error('è¯»å–æ–‡ä»¶æ—¶å‡ºé”™:', error);
                    alert('è¯»å–æ–‡ä»¶æ—¶å‡ºé”™ï¼Œè¯·é€‰æ‹©æœ‰æ•ˆçš„å›¾ç‰‡æ–‡ä»¶');
                }
            } else {
                alert('è¯·å…ˆé€‰æ‹©ä¸€å¼ å›¾ç‰‡');
            }
        }
        
        // å¯¼å‡ºä¸ºPDF
        function exportToPdf() {
            const element = document.getElementById('resumePreview');
            const filename = 'æˆ‘çš„ç®€å†.pdf';
            
            // çº¸å¼ å¤§å°è®¾ç½®ä¸ºA4
            const paperSize = { width: 210, height: 297 };
            
            // åˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„divæ¥åº”ç”¨æ‰“å°æ ·å¼
            const printContent = document.createElement('div');
            printContent.innerHTML = element.innerHTML;
            printContent.className = element.className;
            printContent.style.width = `${paperSize.width}mm`;
            printContent.style.padding = '15mm';
            printContent.style.boxSizing = 'border-box';
            printContent.style.position = 'absolute';
            printContent.style.left = '-9999px';
            printContent.style.fontSize = '9pt'; // ç¼©å°å­—ä½“ä»¥å®¹çº³æ›´å¤šå†…å®¹
            document.body.appendChild(printContent);
            
            // æ·»åŠ æ‰“å°æ ·å¼
            const style = document.createElement('style');
            style.innerHTML = `
                @media print {
                    body, html {
                        -webkit-print-color-adjust: exact;
                    }
                }
            `;
            document.head.appendChild(style);
            
            // æ ¹æ®é€‰æ‹©çš„æ¸…æ™°åº¦è®¾ç½®ç¼©æ”¾æ¯”ä¾‹
            const scale = parseInt(exportResolution);
            
            html2canvas(printContent, {
                scale: scale,
                useCORS: true,
                allowTaint: true,
                width: printContent.offsetWidth,
                windowWidth: printContent.offsetWidth,
                logging: false
            }).then(canvas => {
                document.body.removeChild(printContent);
                document.head.removeChild(style);
                
                const imgData = canvas.toDataURL('image/jpeg', 1.0);
                const pdf = new jspdf.jsPDF('p', 'mm', 'a4');
                const pageWidth = pdf.internal.pageSize.getWidth();
                const pageHeight = pdf.internal.pageSize.getHeight();
                
                // è®¡ç®—å›¾åƒå®½é«˜æ¯”
                const imgWidth = canvas.width;
                const imgHeight = canvas.height;
                const ratio = Math.min(pageWidth / imgWidth, pageHeight / imgHeight);
                
                // è®¡ç®—å±…ä¸­ä½ç½®
                const x = (pageWidth - imgWidth * ratio) / 2;
                const y = 0;
                
                // ç¼©æ”¾å›¾åƒä»¥é€‚åº”æ•´ä¸ªé¡µé¢ï¼Œä¿æŒæ‰€æœ‰å†…å®¹å¯è§
                pdf.addImage(imgData, 'JPEG', x, y, imgWidth * ratio, imgHeight * ratio);
                pdf.save(filename);
            });
        }
        
        // å¯¼å‡ºä¸ºWordæ–‡æ¡£
        function exportToWord() {
            // ä½¿ç”¨docx.jsåº“åˆ›å»ºWordæ–‡æ¡£
            const doc = new docx.Document({
                sections: [
                    {
                        properties: {},
                        children: [
                            new docx.Paragraph({
                                text: "ç®€å†å¯¼å‡º",
                                heading: docx.HeadingLevel.HEADING_1
                            }),
                            new docx.Paragraph({
                                text: "æ³¨æ„ï¼šç”±äºæŠ€æœ¯é™åˆ¶ï¼ŒWordæ ¼å¼å¯èƒ½æ— æ³•å®Œå…¨ä¿ç•™æ‰€æœ‰æ ·å¼å’Œå›¾ç‰‡ã€‚å»ºè®®ä½¿ç”¨PDFæ ¼å¼è·å¾—æœ€ä½³æ•ˆæœã€‚",
                                style: "Emphasis"
                            }),
                            new docx.Paragraph({
                                text: "ä»¥ä¸‹æ˜¯ç®€å†å†…å®¹çš„çº¯æ–‡æœ¬ç‰ˆæœ¬ï¼š",
                                spacing: {
                                    after: 200
                                }
                            })
                        ]
                    }
                ]
            });
            
            // ä¸ºæ¯ä¸ªéƒ¨åˆ†æ·»åŠ å†…å®¹
            for (const section in resumeData) {
                if (resumeData[section]) {
                    // å°†Markdownè½¬æ¢ä¸ºçº¯æ–‡æœ¬
                    const plainText = resumeData[section]
                        .replace(/#+\s+(.*)/g, '$1') // å»é™¤æ ‡é¢˜ç¬¦å·
                        .replace(/\!\[(.*?)\]\((.*?)\)/g, 'å›¾ç‰‡: $1') // æ›¿æ¢å›¾ç‰‡ä¸ºæ–‡å­—æè¿°
                        .replace(/\[(.*?)\]\((.*?)\)/g, '$1 ($2)') // å¤„ç†é“¾æ¥
                        .replace(/\*\*(.*?)\*\*/g, '$1') // å»é™¤ç²—ä½“
                        .replace(/\*(.*?)\*/g, '$1'); // å»é™¤æ–œä½“
                    
                    doc.addSection({
                        properties: {},
                        children: [
                            new docx.Paragraph({
                                text: getDisplayName(section),
                                heading: docx.HeadingLevel.HEADING_1,
                                spacing: {
                                    before: 400,
                                    after: 200
                                }
                            }),
                            new docx.Paragraph({
                                text: plainText
                            })
                        ]
                    });
                }
            }
            
            // ç”Ÿæˆå¹¶ä¸‹è½½Wordæ–‡æ¡£
            docx.Packer.toBlob(doc).then(blob => {
                saveAs(blob, "æˆ‘çš„ç®€å†.docx");
            });
        }
        
        // å¯¼å…¥ç®€å†
        function importResume() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const imported = JSON.parse(e.target.result);
                            resumeData = imported;
                            renderResume();
                            alert('ç®€å†å¯¼å…¥æˆåŠŸï¼');
                        } catch (error) {
                            alert('å¯¼å…¥å¤±è´¥ï¼Œæ–‡ä»¶æ ¼å¼ä¸æ­£ç¡®ï¼');
                            console.error(error);
                        }
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }
        
        // åˆ‡æ¢é¢„è§ˆæ¨¡å¼
        function togglePreview() {
            const preview = document.getElementById('resumePreview');
            if (preview.classList.contains('preview-mode')) {
                closePreviewMode();
            } else {
                // è¿›å…¥é¢„è§ˆæ¨¡å¼
                preview.classList.add('preview-mode');
                document.getElementById('previewBtn').innerHTML = '<i class="fas fa-edit"></i> ç¼–è¾‘';
                
                // åˆ›å»ºå¹¶æ·»åŠ å…³é—­æŒ‰é’®
                const closeBtn = document.createElement('button');
                closeBtn.className = 'close-preview-btn';
                closeBtn.innerHTML = '<i class="fas fa-times"></i>';
                closeBtn.title = 'å…³é—­é¢„è§ˆ';
                closeBtn.addEventListener('click', closePreviewMode);
                document.body.appendChild(closeBtn);
            }
        }
        
        // å…³é—­é¢„è§ˆæ¨¡å¼
        function closePreviewMode() {
            // ç§»é™¤é¢„è§ˆæ¨¡å¼ç±»
            document.getElementById('resumePreview').classList.remove('preview-mode');
            document.getElementById('previewBtn').innerHTML = '<i class="fas fa-eye"></i> é¢„è§ˆ';
            
            // ç§»é™¤å…³é—­æŒ‰é’®
            const closeBtn = document.querySelector('.close-preview-btn');
            if (closeBtn) {
                closeBtn.remove();
            }
        }
        
        // è·å–éƒ¨åˆ†çš„æ˜¾ç¤ºåç§°
        function getDisplayName(section) {
            const nameMap = {
                'personal-info': 'ä¸ªäººä¿¡æ¯',
                'self-evaluation': 'è‡ªæˆ‘è¯„ä»·',
                'work-history': 'å·¥ä½œç»å†',
                'education': 'æ•™è‚²ç»å†',
                'honors': 'è£èª‰å¥–ç« ',
                'skills': 'ä¸“ä¸šæŠ€èƒ½',
                'interests': 'å…´è¶£çˆ±å¥½',
                'languages': 'è¯­è¨€èƒ½åŠ›',
                'projects': 'é¡¹ç›®ç»éªŒ',
                'others': 'å…¶ä»–ä¿¡æ¯'
            };
            return nameMap[section] || section;
        }
    </script>
</body>
</html> 